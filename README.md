# Movie Rating Analysis using HDFS

This project aims to analyze movie review ratings data using a Hadoop MapReduce solution. The analysis identifies the film(s) with the highest average rating for each year within a specified range of years and across all years, based on the ratings provided by a group of reviewers.

## Input Data

The input data is sourced from the `ratings.txt` file, containing over 100,000 ratings. Each line in the file represents an individual user's rating for a particular movie, structured as follows:
```bash
<Reviewer ID> <Movie Title> <Genres> <Year> <Rating>
```
- The `Genres` field may contain one genre or multiple genres separated by a vertical bar (`|`). Each genre is associated with the rating value.

## Years Configuration

The `years.txt` file contains a list of years that movies must have been released in to be included in the analysis. If a movie's release year is not listed in this file, it should be excluded from the analysis results. If `years.txt` is empty, all ratings and years will be included in the analysis.

## MapReduce Implementation

The solution comprises Python-based Hadoop MapReduce scripts designed to execute on HDFS. The provided scripts (`mapper.py`, `combiner.py`, and `reducer.py`) follow the MapReduce paradigm to process the input data and identify the top-rated movies for each year.

- **Mapper (`mapper.py`):**
  - Reads input data from standard input (`stdin`).
  - Filters movies based on the years listed in `years.txt`.
  - Splits genres to associate each genre with its corresponding rating.
  - Outputs key-value pairs in the format: `year \t title \t (count * rating) \t count`.

- **Combiner (`combiner.py`):**
  - Aggregates data based on the output of the Mapper.
  - Groups movies by year and title.
  - Calculates the sum of ratings and the count of ratings for each movie.
  - Outputs intermediate results in the format: `year \t title \t sum_of_ratings,count_of_ratings`.

- **Reducer (`reducer.py`):**
  - Processes the intermediate results generated by the Combiner.
  - Calculates the average rating for each movie.
  - Identifies the top-rated movies for each year, considering a minimum vote threshold.
  - Outputs the final results in the format: `year \t title \t avg_rating`.

## Execution

To execute the solution:
1. Ensure data is stored on HDFS.
2. Execute the script to run the Hadoop MapReduce job.

## Output Format

The final output is in TSV (tab-separated value) format, presenting the top-rated movie(s) for each year along with their average rating for the specified range of years.

In case of ties, where multiple movies have the same highest average rating for a year, each movie is listed separately.

## Requirements

- Python 3.x environment for executing MapReduce scripts.
- Access to HDFS for storing and processing data.
